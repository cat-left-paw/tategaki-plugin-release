# QUICKSTART（最短で使い始める）

このページは「まず動かしてみる」ための最短ガイドです。  
インストールがまだの方は、先に `INSTALL.md` を参照してください。

このプラグインには 3 つのモードがあります。

-   執筆モード（実験的）：見たまま編集（変換・同期あり）
-   参照モード：Obsidian 側の編集内容をほぼリアルタイムに参照（安全な編集補助）
-   書籍モード：ページめくりで読む（閲覧専用）

---

## 1. Tategaki ビューを開く

※新規に書き始めたい場合は、先に Obsidian 側で「新規ノート」を作成してから開いてください。

起動方法はいくつかあります。

### 方法 A: リボン（左側のアイコン）から開く

左側のリボンにある「縦書きビューを開く」アイコンを押します。

### 方法 B: コマンドから開く

1. Obsidian で任意のノート（`.md`）を開きます
2. コマンドパレット（`Ctrl+P` / `Cmd+P`）を開きます
3. `縦書きビューを開く` を実行します

画面の右側に Tategaki ビューが開きます。

### 便利: ショートカットキーを割り当てる

Obsidian の 設定 → `ホットキー` から、`縦書きビューを開く` を検索してショートカットを割り当てると便利です。

---

## 2. 共通（どのモードでも）

### モード切り替え（執筆 / 参照 / 書籍）

ツールバーのモードボタン、またはモード切替の UI から切り替えできます。

### ファイルの追従（ピン留め）

Tategaki ビューは、Obsidian でアクティブにしたノートを追いかけて表示できます。

-   追従をオン：アクティブなノートが自動で表示されます
-   ピン留め：表示中のノートを固定して、別のノートに切り替えても変わりません

操作方法:

-   設定の `アクティブファイルを追従する` をオン/オフ
-   または、ツールバーのピン（「編集ファイルを固定」）で切り替え

### 縦書き/横書きの切り替え

ツールバーの切り替えボタン、またはコマンド `書字方向を切り替え（縦書き/横書き）` で切り替えられます。

### 表示のカスタマイズ（テーマ/フォント/色 など）

設定画面のテーマ機能で、フォント、文字サイズ、行間、色などを自由に調整できます（複数のテーマを保存して切り替えも可能です）。

---

## 3. 執筆モード（実験的：見たまま編集）

### 編集してみる（保存/同期）

執筆モードでは、Tategaki 側で編集した内容を、元の Markdown ファイルへ反映します（変換・同期あり）。

### 同期モード（自動 / 手動）

設定で「同期モード」を選べます。

-   自動同期: 編集に合わせて自動で反映されます（普段はこちら）
-   手動同期: 自分で保存操作をしたときだけ反映されます（大事な原稿で安心）

手動同期の場合:

-   ツールバーの保存ボタン、または `Ctrl+Shift+S` / `Cmd+Shift+S` で反映します
-   右上の状態表示が「未保存」のときは、反映されていない状態です

> 大事な原稿は、最初は「手動同期」＋バックアップ（複製や Git 等）をおすすめします。

### 同期バックアップ（同期の前後）

同期の安全策として、同期のたびに **同期前（before）/同期後（after）** の内容をバックアップとして保存します。

-   保存場所: `.obsidian/tategaki-sync-backups/`
-   ファイル名: `YYYYMMDD-HHMM_<reason>__before.md` と `YYYYMMDD-HHMM_<reason>__after.md`

バックアップはノートごとに保存され、古いものは一定数に整理されます。

### 自動バックアップ（執筆モード）

執筆モードでは、手動同期だけでなく、次のタイミングでもバックアップが自動で作成される場合があります。

-   セッション開始時
-   一定間隔（例: 20分おき、未同期の変更がある場合）
-   大量ペーストや、ルビ/装飾など「変換リスクが高い操作」の前後

バックアップの保存場所は同じで、ノートごとにフォルダが分かれます（例: `.obsidian/tategaki-sync-backups/<ファイル別フォルダ>/`）。

### よく使う機能

-   ルビ（青空文庫形式）: `｜漢字《かんじ》`（ツールバーで表示オン/オフ）
-   文字装飾（太字/イタリック/ハイライト/見出しなど）: ツールバー or 右クリック
-   ソーステキスト編集: Markdown 文字列を直接編集（重い原稿で有効）
-   補助入力パネル: 別の入力方法で編集（重い原稿で有効）
-   リスト項目を上下に入れ替え（アウトライナー風）
    -   横書き: `Ctrl` / `Cmd` + `↑` / `↓`
    -   縦書き: `Ctrl` / `Cmd` + `→` / `←`

---

## 4. 参照モード（安全な編集補助）

参照モードは、Obsidian 側（通常のエディタ）で編集している Markdown を、ほぼリアルタイムに表示します。
変換や同期を最小化し、Obsidian の Markdown を直接扱うため、執筆モードより安全に編集できます。

使いどころ:

-   大事な原稿を、安全に編集したい（編集は Obsidian 側で行う）
-   執筆モードの変換・同期が不安な場合

---

## 5. 書籍モード（ページめくりで読む）

書籍モードは、閲覧に特化した「ページめくり」表示です（閲覧専用）。
簡単なページ遷移アニメーション（設定で変更可）

### ページ移動

-   マウスホイール、キーボード（PageUp/PageDown など）でページ移動できます
-   アウトラインがある場合は、見出しジャンプも利用できます
-   ※新しいウィンドウ（独立したウィンドウ）で開いた場合、マウスホイールでのページ移動ができません（方向キー / PageUp / PageDown は利用できます）。次回以降のアップデートで修正予定です。

### モバイルでも読む

小さい画面では編集が難しいため、執筆モードはあまりおすすめしません。  
一方で、書籍モードの閲覧用途であれば、モバイルでも使用できます（端末性能や文章量によっては重くなる場合があります）。

---

## 6. 制限（主に執筆モード）

### 未対応の HTML タグ（執筆モード）

執筆モードでは、本文に `<div>` のような HTML タグ（`<...>`）が含まれていると、タグの種類によっては変換できず、編集画面で扱えない場合があります。  
タグを「文章として」含めたい場合はコードブロックに入れてください。

```text
<div>これはタグではなく文字として見せたい</div>
```

### 重い原稿について（執筆モード）

使用する環境によっては、**巨大なテキスト**、特に**ルビを多用したテキスト**で表示や編集が重くなることがあります（とくにテキスト末尾での編集）。

重く感じるときは、次を試してください。

-   ルビ表示をオフにする
-   「ソーステキスト編集」を使う
-   「補助入力パネル」を使う

それでも重い場合は、章ごとにノートを分割するなど、テキスト量を減らすと改善します。

---

## 7. 困ったとき（安全策）

### 同期バックアップから復元（執筆モード）

変換や同期がうまくいかなかった場合に備えて、同期バックアップを使えます。

1. コマンドパレット（`Ctrl+P` / `Cmd+P`）
2. `直前の同期バックアップを開く/復元` を実行

### バックアップを整理したい

バックアップは設定画面（またはコマンド）から「同期バックアップをゴミ箱へ移動」でまとめて消せます。

---

## 次に読む

-   `INSTALL.md`: インストール/アンインストール（OS 別）
-   `MANUAL.md`: 機能の詳しい説明
