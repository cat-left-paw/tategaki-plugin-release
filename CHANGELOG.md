# Changelog

このプロジェクトの主な変更点をまとめます。

形式は Keep a Changelog に概ね準拠し、バージョンは SemVer に従います。

## [Unreleased]

_現在は未リリースの変更はありません。_

## [1.2.1] - 2026-02-07

### Added

- 書籍モード（表示設定）に上下余白設定を追加
- ビュー上部ラベルを改善し、`Tategaki` 固定表示ではなく `frontmatter.title` またはファイル名（拡張子なし）を表示
- 全文プレーン表示機能を追加

### Changed

- SoT + Overlay IME + Native選択補助の挙動を見直し、フォーカス競合を減らす方向で調整
- 選択ハイライト更新の負荷を調整し、長いドラッグ選択/オートスクロール時の視覚的な安定性を改善
- モバイル方針を見直し、限定対応に変更（閲覧推奨、編集はタブレット推奨）
- 互換モード（TipTap版）を当面維持する方針に整理
- モバイル編集時は右クリックメニューを表示しない挙動に変更

### Fixed

- SoT + Overlay IME + `useNativeSelection` 関連の不具合をまとめて修正（範囲選択中の右クリックで選択解除される問題、スクロールバーのドラッグ後に選択ハイライトが消える問題、Shift+方向キー選択後にツールバー装飾が効かない問題、未選択状態で右クリックメニュー「すべてを選択」が動作しない問題）
- 1.2.0で発生していた、IME表示が本文に重なってしまう問題を修正
- 書籍モードでページ末尾の最終行が不自然に伸長してしまう問題を修正
- その他多数の軽微な不具合を修正

## [1.2.0] - 2026-01-29

### Added

- **（新）執筆・参照モード（WYSIWYG）を追加**
    - Obsidian の Markdown を直接編集する新方式（変換・同期処理が不要）
    - ペアノートをアクティブにすると、（新）執筆・参照モードのビューが参照表示として追従
    - 見出しの折りたたみ機能
    - 見出し（アウトライン）ジャンプ機能
    - 設定パネルからフォント・余白などを手軽に調整可能
    - 同期バックアップ不要（同期リスクなし）
    - ペアノート方式（Obsidian のノートと縦書きビューが連動）
- （新）執筆・参照モードの上下余白設定を設定パネルから調整可能に
- 互換モード: 同期バックアップの作成をON/OFFできる設定を追加
- 互換モード: 同期バックアップフォルダを開くボタンを追加

### Changed

- TipTap 版の執筆モードを「互換モード」に変更
    - v1.1.1 以前の執筆モード（変換・同期あり）として引き続き利用可能
    - 当面維持
- モバイル非対応に変更（`manifest.json` の `isDesktopOnly: true`）
- プラグイン設定・表示設定の整理
- 表示設定の項目を追加（IME表示補正、キャレット設定、書籍モードのヘッダー/フッターなど）

### Removed

- コマンドパレットから以下のコマンドを削除
    - 執筆・参照を切り替え
    - 書字方向を切り替え（縦書き・横書き）
    - 書籍モードビューを開く・閉じる
    - 直前の同期バックアップを開く・復元

### Fixed

- 書籍モード: ページを跨ぐ際にルビつきの文字があるとレイアウトが乱れる問題を修正

## [1.1.1] - 2026-01-05

### Fixed

- 執筆モード（モバイル環境）: Enter が `<br>` になっていた問題を修正（通常 Enter は段落分割、Shift+Enter のみ `<br>`）

### Added

- （新）執筆・参照モードの WYSIWYG 編集ビューを同梱
    - Obsidian の CodeMirror を直接参照するため、既存ノートの内容は安全に保持されます

## [1.1.0] - 2026-01-03

### Changed

- 同期バックアップ（自動バックアップ）を大幅に見直し
    - 以前: 同期のたびに無条件で作成し、最新 5 ペアを超えると古いものから削除
    - 変更後: セッション開始時/手動同期/一定間隔（例: 20 分、dirty 時のみ）/大量ペースト/危険な変更（ルビ・装飾など）といった理由に応じて作成し、保持も「使用日ベース」などの方針で整理

### Added

- モード追加: 執筆モード(v1.0.0 公開時の WYSIWYG 編集機能) / 参照モード(新設) / 書籍モード(新設)
- 参照モード: Obsidian 側の編集内容をほぼリアルタイムに参照できる表示（同期や変換を最小化）
- 参照モード: Obsidian の Markdown を直接扱うため、変換や同期を伴う執筆モードより安全な編集用ワークフローを提供
- 書籍モード: 高速な実測ベースのページ分割（長文でも操作性を維持するための時間スライス処理）
- 書籍モード: アウトライン表示・見出しジャンプ（ページ生成に合わせて追記）
- 書籍モード: ページ遷移効果（フェード等）
- テーマ: プリセットテーマ追加（アッシュベリー（ライト）、アッシュベリー（ダーク）、ダスティネイビー）

### Fixed

- その他: UI などの細かい修正

### Known Issues

- 書籍モード: 新しいウィンドウ（独立したウィンドウ）で開いた場合、マウスホイールでのページ移動ができません（方向キー / PageUp / PageDown は利用できます）。次回以降のアップデートで修正予定です。
- 書籍モード: ページ分割中にマウスホイールを操作すると、ちらつきが発生する場合があります（次回以降のアップデートで改善予定）。

## [1.0.0] - 2025-12-29

### Added

- 初回リリース
